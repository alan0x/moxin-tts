# TTS Screen é‡æ„è¿›åº¦æŠ¥å‘Š

**æ—¥æœŸ**: 2026-02-03
**çŠ¶æ€**: ğŸš§ è¿›è¡Œä¸­

---

## âœ… å·²å®Œæˆå·¥ä½œ

### 1. ä¸»é¢˜è‰²å®šä¹‰ âœ“
**æ–‡ä»¶**: `mofa-widgets/src/theme.rs`

æ·»åŠ äº†å®Œæ•´çš„ MoYoYo.tts é…è‰²æ–¹æ¡ˆï¼š

```rust
// æµ…è‰²ä¸»é¢˜
MOYOYO_BG_PRIMARY = #ffffff         // ä¸»èƒŒæ™¯
MOYOYO_BG_SECONDARY = #f5f7fa       // å¡ç‰‡èƒŒæ™¯
MOYOYO_PRIMARY = #6366f1            // å“ç‰Œè‰²ï¼ˆé›è“ï¼‰
MOYOYO_TEXT_PRIMARY = #303133       // ä¸»æ–‡æœ¬
MOYOYO_TEXT_SECONDARY = #606266     // æ¬¡çº§æ–‡æœ¬

// æ·±è‰²ä¸»é¢˜
MOYOYO_BG_PRIMARY_DARK = #1a1a1a
MOYOYO_BG_SECONDARY_DARK = #252525
MOYOYO_TEXT_PRIMARY_DARK = #e5eaf3
```

### 2. Card ç»„ä»¶ âœ“
**æ–‡ä»¶**: `mofa-widgets/src/card.rs`

åˆ›å»ºäº†ä¸‰ä¸ªå¡ç‰‡å˜ä½“ï¼š
- `Card` - æ ‡å‡†å¡ç‰‡ï¼ˆ16px padding, 12px åœ†è§’ï¼‰
- `CardHoverable` - å¸¦æ‚¬åœæ•ˆæœçš„å¡ç‰‡
- `CardCompact` / `CardLarge` - ç´§å‡‘/å¤§å°ºå¯¸ç‰ˆæœ¬

### 3. æ–°çš„ UI å¸ƒå±€ âœ“
**æ–‡ä»¶**: `apps/mofa-tts/src/screen_new.rs`

åˆ›å»ºäº†å…¨æ–°çš„ MoYoYo.tts é£æ ¼å¸ƒå±€ï¼š

```
TTSScreen
â””â”€â”€ main_content (å±…ä¸­å¸ƒå±€)
    â””â”€â”€ content_container (æœ€å¤§å®½åº¦ 800px)
        â”œâ”€â”€ hero (MofaHero - ç³»ç»ŸçŠ¶æ€)
        â”œâ”€â”€ page_title "Text to Speech"
        â”œâ”€â”€ selectors_row
        â”‚   â”œâ”€â”€ voice_selector_section (520px)
        â”‚   â””â”€â”€ language_selector_section (260px)
        â”œâ”€â”€ text_input_card (Card)
        â”‚   â”œâ”€â”€ TextInput
        â”‚   â””â”€â”€ input_footer (å­—ç¬¦è®¡æ•° + Generate æŒ‰é’®)
        â””â”€â”€ audio_player_card (Card, æ¡ä»¶æ˜¾ç¤º)
            â”œâ”€â”€ player_header
            â””â”€â”€ player_controls
                â”œâ”€â”€ play_btn
                â”œâ”€â”€ progress_container
                â””â”€â”€ download_btn
```

### 4. MoYoYo é£æ ¼ç»„ä»¶ âœ“

åœ¨ `screen_new.rs` ä¸­å®šä¹‰äº†ï¼š
- `PageTitle` - é¡µé¢æ ‡é¢˜ï¼ˆ24pxï¼‰
- `SectionLabel` - åŒºåŸŸæ ‡ç­¾ï¼ˆ14pxï¼‰
- `MoyoyoButton` - ä¸»æŒ‰é’®ï¼ˆ#6366f1 å“ç‰Œè‰²ï¼‰
- `MoyoyoPlayButton` - åœ†å½¢æ’­æ”¾æŒ‰é’®ï¼ˆ48pxï¼‰
- `DownloadButton` - ä¸‹è½½æŒ‰é’®ï¼ˆç»¿è‰²ï¼‰
- `ProgressSlider` - è¿›åº¦æ¡
- `TimeLabel` - æ—¶é—´æ˜¾ç¤º
- `CharCountLabel` - å­—ç¬¦è®¡æ•°

---

## ğŸ”„ å¸ƒå±€å¯¹æ¯”

### åŸå¸ƒå±€ï¼ˆå¤æ‚ï¼‰
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Hero (ç³»ç»ŸçŠ¶æ€æ )                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æ–‡æœ¬è¾“å…¥åŒº            â”‚ è¯­éŸ³é€‰æ‹©å™¨   â”‚ ç³»ç»Ÿæ—¥å¿—é¢æ¿  â”‚
â”‚ (å·¦åˆ—ï¼Œè‡ªé€‚åº”)        â”‚ (280px)    â”‚ (300px)      â”‚
â”‚                      â”‚            â”‚ [å¯è°ƒæ•´å¤§å°]  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚ åº•éƒ¨æ’­æ”¾å™¨æ  (90px é«˜)                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ–°å¸ƒå±€ï¼ˆç®€æ´ï¼‰
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     Content (æœ€å¤§ 800px)      â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Hero (ç³»ç»ŸçŠ¶æ€)           â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                              â”‚
â”‚ Text to Speech               â”‚
â”‚                              â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚ â”‚ Voice â–¼ â”‚ â”‚ Language â”‚    â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                              â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ ğŸ“ Text Input Area       â”‚ â”‚
â”‚ â”‚ [Enter text here...]     â”‚ â”‚
â”‚ â”‚                          â”‚ â”‚
â”‚ â”‚ 45/5000     [Generate] â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                              â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ ğŸ”Š Generated Audio       â”‚ â”‚
â”‚ â”‚ â–¶ï¸ â”â”â”â”â—â”â”â”â”â”  ğŸ”½ Save  â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å…³é”®å˜åŒ–**ï¼š
- âœ… å•åˆ—å±…ä¸­å¸ƒå±€ï¼ˆæœ€å¤§å®½åº¦ 800pxï¼‰
- âœ… ç§»é™¤æ—¥å¿—é¢æ¿ï¼ˆç®€åŒ–ä¸ºç‹¬ç«‹åº”ç”¨ï¼‰
- âœ… ç§»é™¤å¯è°ƒæ•´å¤§å°çš„åˆ†éš”æ¡
- âœ… å¡ç‰‡å¼è®¾è®¡ï¼ˆä½¿ç”¨ Card ç»„ä»¶ï¼‰
- âœ… éŸ³é¢‘æ’­æ”¾å™¨æ”¹ä¸ºå¡ç‰‡ï¼ˆæ¡ä»¶æ˜¾ç¤ºï¼‰
- âœ… MoYoYo é…è‰²å’Œç»„ä»¶é£æ ¼

---

## ğŸ”§ ä¸‹ä¸€æ­¥å·¥ä½œ

### Step 1: è¿ç§» Toast ç»„ä»¶å®šä¹‰ â³
ä»åŸ `screen.rs` å¤åˆ¶ Toast ç›¸å…³çš„ live_design ä»£ç åˆ° `screen_new.rs`

### Step 2: è¿ç§» Rust å®ç°ä»£ç  â³
å°†ä»¥ä¸‹å†…å®¹ä» `screen.rs` å¤åˆ¶åˆ° `screen_new.rs`ï¼š

1. **ç»“æ„ä½“å®šä¹‰**
   ```rust
   pub struct TTSScreen {
       #[deref] view: View,
       #[rust] tts_status: TTSStatus,
       #[rust] audio_player: Option<TTSPlayer>,
       #[rust] dora: Option<DoraIntegration>,
       // ... å…¶ä»–å­—æ®µ
   }
   ```

2. **Widget trait å®ç°**
   - `handle_event()` æ–¹æ³•
   - `draw_walk()` æ–¹æ³•

3. **ä¸šåŠ¡é€»è¾‘æ–¹æ³•**
   - TTS ç”Ÿæˆé€»è¾‘
   - éŸ³é¢‘æ’­æ”¾æ§åˆ¶
   - è¯­éŸ³ç®¡ç†
   - æ—¥å¿—å¤„ç†
   - Dora é›†æˆ

### Step 3: æ›´æ–° Widget ID è·¯å¾„ â³
å°†æ‰€æœ‰çš„ widget ID è·¯å¾„ä»ï¼š
```rust
ids!(content_wrapper.main_content.left_column.content_area.controls_panel.voice_selector)
```
æ”¹ä¸ºï¼š
```rust
ids!(main_content.content_container.selectors_row.voice_selector_section.voice_selector_container.voice_selector)
```

### Step 4: æµ‹è¯•ç¼–è¯‘ â³
```bash
cargo check -p mofa-tts
```

### Step 5: æ›¿æ¢åŸæ–‡ä»¶ â³
```bash
# å¤‡ä»½å·²å®Œæˆ
# mv screen.rs screen.rs.old
# mv screen_new.rs screen.rs
```

### Step 6: åŠŸèƒ½æµ‹è¯• â³
- [ ] TTS ç”ŸæˆåŠŸèƒ½
- [ ] éŸ³é¢‘æ’­æ”¾
- [ ] è¯­éŸ³é€‰æ‹©
- [ ] è¯­éŸ³å…‹éš†
- [ ] æš—é»‘æ¨¡å¼åˆ‡æ¢
- [ ] Dora è¿æ¥çŠ¶æ€

---

## ğŸ“ æŠ€æœ¯å†³ç­–

### 1. ä¸ºä»€ä¹ˆåˆ›å»ºæ–°æ–‡ä»¶è€Œä¸æ˜¯ç›´æ¥ä¿®æ”¹ï¼Ÿ
- âœ… ä¿æŒåŸæ–‡ä»¶å®Œæ•´ï¼Œå¯éšæ—¶å›é€€
- âœ… ä¾¿äºå¯¹æ¯”æ–°æ—§å®ç°
- âœ… é™ä½å‡ºé”™é£é™©

### 2. ä¸ºä»€ä¹ˆç§»é™¤æ—¥å¿—é¢æ¿ï¼Ÿ
- âœ… moxin-tts æ˜¯ç‹¬ç«‹åº”ç”¨ï¼Œä¸éœ€è¦è°ƒè¯•ç•Œé¢
- âœ… ç®€åŒ–å¸ƒå±€ï¼Œèšç„¦æ ¸å¿ƒåŠŸèƒ½
- âœ… æ›´æ¥è¿‘ MoYoYo.tts çš„è®¾è®¡ç†å¿µ

### 3. ä¸ºä»€ä¹ˆä½¿ç”¨ 800px æœ€å¤§å®½åº¦ï¼Ÿ
- âœ… åŒ¹é… MoYoYo.tts çš„è®¾è®¡
- âœ… é€‚åˆå¤§å¤šæ•°å±å¹•å°ºå¯¸
- âœ… å†…å®¹å±…ä¸­ï¼Œæ›´ç°ä»£çš„è§†è§‰æ•ˆæœ

---

## ğŸ¨ è§†è§‰æ•ˆæœé¢„è§ˆ

### é…è‰²æ–¹æ¡ˆ
| å…ƒç´  | æµ…è‰²æ¨¡å¼ | æ·±è‰²æ¨¡å¼ |
|------|---------|---------|
| èƒŒæ™¯ | #ffffff (ç™½è‰²) | #1a1a1a (æ·±ç°) |
| å¡ç‰‡ | #f5f7fa (æµ…ç°è“) | #252525 (ç°) |
| ä¸»æŒ‰é’® | #6366f1 (é›è“) | #6366f1 (é›è“) |
| æˆåŠŸæŒ‰é’® | #10b981 (ç»¿è‰²) | #10b981 (ç»¿è‰²) |
| æ–‡æœ¬ | #303133 (æ·±ç°) | #e5eaf3 (æµ…ç°) |

### ç»„ä»¶æ ·å¼
- **åœ†è§’**: 8-12pxï¼ˆç»Ÿä¸€çš„ç°ä»£é£æ ¼ï¼‰
- **å†…è¾¹è·**: 16-24pxï¼ˆèˆ’é€‚çš„ç•™ç™½ï¼‰
- **å­—ä½“å¤§å°**:
  - æ ‡é¢˜: 24px
  - æ­£æ–‡: 15px
  - æ ‡ç­¾: 14px
  - æç¤º: 13px

---

## ğŸ› å·²çŸ¥é—®é¢˜

1. **Toast ç»„ä»¶æœªè¿ç§»**: éœ€è¦ä»åŸæ–‡ä»¶å¤åˆ¶
2. **ConfirmDeleteModal æœªè¿ç§»**: éœ€è¦ä»åŸæ–‡ä»¶å¤åˆ¶
3. **è¯­è¨€é€‰æ‹©å™¨**: å½“å‰æ˜¯ä¸´æ—¶çš„æŒ‰é’®ç»„ï¼Œéœ€è¦åç»­ä¼˜åŒ–
4. **VoiceSelector**: å¯èƒ½éœ€è¦è°ƒæ•´ä»¥é€‚åº”æ–°å¸ƒå±€

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [UI è¿ç§»è®¡åˆ’](./UI_MIGRATION_PLAN.md) - æ€»ä½“è¿ç§»ç­–ç•¥
- [é‡æ„æ–¹æ¡ˆ](./TTS_SCREEN_REFACTOR_PLAN.md) - è¯¦ç»†é‡æ„æ–¹æ¡ˆ
- [ä¸Šä¸‹æ–‡æ¢å¤](./CONTEXT_RESUME.md) - é¡¹ç›®èƒŒæ™¯

---

## ğŸš€ å¿«é€Ÿç»§ç»­

å¦‚æœä½ ç°åœ¨æƒ³ç»§ç»­ï¼Œæ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼š

1. **æŸ¥çœ‹æ–°å¸ƒå±€**ï¼š
   ```bash
   code apps/mofa-tts/src/screen_new.rs
   ```

2. **è¿ç§»ä¸šåŠ¡é€»è¾‘**ï¼š
   ä» `screen.rs` å¤åˆ¶ Rust å®ç°ä»£ç åˆ° `screen_new.rs`

3. **æµ‹è¯•ç¼–è¯‘**ï¼š
   ```bash
   cargo check -p mofa-tts
   ```

4. **æ›¿æ¢æ–‡ä»¶**ï¼ˆè°¨æ…ï¼ï¼‰ï¼š
   ```bash
   mv apps/mofa-tts/src/screen.rs apps/mofa-tts/src/screen.rs.old
   mv apps/mofa-tts/src/screen_new.rs apps/mofa-tts/src/screen.rs
   ```

---

**ç»§ç»­å‰è¯·å‘Šè¯‰æˆ‘ä½ çš„é€‰æ‹©ï¼š**

A. ç°åœ¨ç«‹å³è¿ç§»ä¸šåŠ¡é€»è¾‘ä»£ç 
B. å…ˆæµ‹è¯•æ–° UI èƒ½å¦ç¼–è¯‘
C. é€æ­¥è¿›è¡Œï¼Œä¸€æ­¥ä¸€æ­¥æ¥
D. ä½ çš„å…¶ä»–æƒ³æ³•
